name: run-tests

description: "Install lance wheel and run unit tests"
inputs:
  python-minor-version:
    required: true
    description: "8 9 10 11 12"
runs:
  using: "composite"
  steps:
    - name: Install lancedb
      shell: bash
      run: |
        pip3 install $(ls target/wheels/lancedb-*.whl)[tests,dev,embeddings]
    - name: pytest
      shell: bash
      run: python -mpytest -m "not slow" -x -v --durations=30 python/python/tests
    - name: debug
      shell: bash
      run: |
        python -c "import lancedb; print(lancedb.__file__)"
        find /opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/lancedb
    - name: doctest
      shell: bash
      run: python -mpytest --doctest-modules python/python/lancedb
